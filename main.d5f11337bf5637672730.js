(()=>{"use strict";var e,t={377:(e,t,o)=>{var n=o(561),d=o(74),r=o(988),i=o(933),c=o(519);class s{#e;#t;#o;static MIN_PRIORITY=0;static MAX_PRIORITY=3;static#n=new Map;constructor({title:e,description:t,dueDate:o,priority:d,id:r,isComplete:i,completedDate:c},a=null){this.title=e||"New Todo",this.description=t,this.dueDate=o,this.priority=d,this.isComplete=i??!1,this.id=r??(0,n.Ak)(8),this.completedDate=c??null,this.project=null===a?{id:null}:a,s.#n.set(this.id,this)}get id(){return this.#e}set id(e){this.#e=e}markComplete(){this.isComplete=!0,this.completedDate=(new Date).toDateString()}markIncomplete(){this.isComplete=!1,this.completedDate=null}toggleCompletion(){this.isComplete=!this.isComplete}updateProperty(e,t){e in this&&(this[e]=t)}get priority(){return this.#t}set priority(e=0){const t=+e;(Number.isNaN(t)||t<s.MIN_PRIORITY||t>s.MAX_PRIORITY)&&(this.#t=0),this.#t=t}get dueDate(){return this.#o}set dueDate(e){const t=new Date(e);this.#o=(0,d.f)(t)?e:null}static get todos(){return Array.from(s.#n.values())}static getTodoByID(e){return s.#n.get(e)}static removeTodo(e){s.#n.delete(e)}static getTodosForProject(e){return s.todos.filter((t=>t.project.id===e))}static getCompletedTodosForProject(e){return s.todos.filter((t=>t.project.id===e&&t.isComplete)).sort(((e,t)=>new Date(t.completedDate)-new Date(e.completedDate)))}static getIncompleteTodosForProject(e){return s.todos.filter((t=>t.project.id===e&&!t.isComplete))}static get incompleteTodosToday(){return s.todos.filter((e=>!e.isComplete&&(0,r.c)(e.dueDate)))}static get incompleteHighPriorityTodos(){return s.todos.filter((e=>!e.isComplete&&e.priority===s.MAX_PRIORITY))}static get overdueTodos(){return s.todos.filter((e=>!e.isComplete&&(0,i.R)((0,c.D)(e.dueDate)))).sort(((e,t)=>new Date(t.dueDate)-new Date(e.dueDate)))}}class a{#e;static#d=new Map;constructor(e,t){this.name=e,this.id=t??`${(0,n.Ak)(6)}`,a.#d.set(this.id,this)}get id(){return this.#e}set id(e){this.#e=e}static get projects(){return Array.from(a.#d.values())}static get projectNames(){return a.projects.map((e=>e.name))}static getProjectByID(e){return a.#d.get(e)}static removeProject(e){const t=s.getTodosForProject(e);if(t)for(const e of t)s.removeTodo(e.id);a.#d.delete(e)}}const l={todo:document.querySelector("#todo-form"),project:document.querySelector("#project-form")},u={sidebar:document.querySelector("#sidebar"),todoList:document.querySelector("#todos"),projectList:document.querySelector("#projects-list"),projectHeading:document.querySelector(".project-heading"),inboxItem:document.querySelector("#inbox-nav-item"),inboxButton:document.querySelector("#inbox-nav-item .project-btn"),todayNavButton:document.querySelector("#today-nav-item .project-btn"),priorityNavButton:document.querySelector("#priority-nav-item .project-btn"),projectInput:l.project.querySelector("input"),addTodoButton:document.querySelector("#add-todo-btn"),confirmDialog:document.querySelector("dialog#confirm-dialog"),completedContainer:document.querySelector("section.completed-section"),completedList:document.querySelector("#completed-todos"),themeSelector:document.querySelector("#theme-selector")};function m(e,t){return(o,n,d)=>{e.replaceChildren();for(const r of o){const o=t(r,n,d);e.append(o)}}}function p(e=""){const t=document.createElement("span");return t.classList.add("icon","material-symbols-outlined"),t.textContent=e,t}const h=(e,t)=>{let o=null;o=t||(()=>{const e=document.createElement("button"),t=p("more_vert");return e.classList.add("menu-btn"),e.append(t),e})();const n=document.createElement("ul");n.classList.add("dropdown-menu","hidden");for(const t of e){const e=document.createElement("li"),o=p(t.icon),d=document.createElement("span");d.classList.add("text"),d.textContent=t.text,e.append(o,d),e.addEventListener("click",(()=>{t.handler(e),r()})),n.append(e)}function d(e){o.contains(e.target)||n.contains(e.target)||r()}function r(){n.classList.toggle("hidden"),o.classList.toggle("active"),n.classList.contains("hidden")?document.removeEventListener("click",d):document.addEventListener("click",d)}return o.addEventListener("click",r),{button:o,menu:n}},v=m(u.projectList,(function(e,t){const o=document.createElement("li");o.classList.add("nav-item"),o.dataset.id=e.id;const n=p("tag"),d=document.createElement("span");d.classList.add("text"),d.textContent=e.name;const r=document.createElement("button");r.classList.add("project-btn"),r.addEventListener("click",(()=>{t.onClick(e)})),r.append(n,d);const i=h([{text:"Rename",icon:"edit",handler(){t.onClick(e),u.projectHeading.querySelector("input").focus()}},{text:"Delete",icon:"delete",handler(){t.onDelete(e.id)}}]);return o.append(r,i.button,i.menu),o}));function f(e){const t=document.querySelector(".nav-item.active");t?.classList.remove("active");const o=document.querySelector(`.nav-item[data-id="${e}"]`);o?.classList.add("active")}function y(e){"Escape"===e.key&&e.target.blur()}u.projectInput.addEventListener("blur",(e=>{e.target.value=null,document.removeEventListener("keydown",y)})),u.projectInput.addEventListener("focus",(()=>{document.addEventListener("keydown",y)}));var g=o(764),L=o(730),E=o(399),j=o(727);function D(e,{onlyDate:t=!1,showOverdue:o=!1}={}){const n=(0,g.c)((0,L.o)(e),(0,L.o)(new Date));let d;return d=o&&n<0?"Overdue":0===n?"Today":1!==n||t?n>1&&n<15&&!t?`${n} days left`:-1!==n||t?n<-1&&n>-15&&!t?`${Math.abs(n)} days ago`:(0,E.e)(e)?(0,j.GP)(e,"MMM d"):(0,j.GP)(e,"MMM y"):"Yesterday":"Tomorrow",{daysDiff:n,relativeDateDescription:d}}function b(e,t,{showProject:o=!1,showPriority:n=!0,showDueDate:d=!0,showOverdue:r=!1}={}){const i=document.createElement("li");i.classList.add("todo-item"),i.dataset.id=e.id;const c=document.createElement("div");c.classList.add("todo-header");const s=document.createElement("h3");s.classList.add("title"),s.textContent=e.title;const a=k(e.isComplete,e.id,t.onTodoComplete);if(c.append(a,s),n){const t=T(e.priority);c.append(t)}const u=S(e.description),m=document.createElement("div");m.classList.add("info-container"),m.append(c,u);const v=document.createElement("div");if(v.classList.add("right-container"),o){const t=function(e){const t=document.createElement("div");t.classList.add("project");const o=p(e.id?"tag":"inbox"),n=document.createElement("span");return n.classList.add("text"),n.textContent=e.name??"Inbox",t.append(o,n),t}(e.project);v.append(t)}if(d||r){const t=w(e.dueDate,r);v.append(t)}const f=()=>{q(i,e),l.todo.removeEventListener("submit",P.addTodo),l.todo.addEventListener("submit",P.editTodo)},y=h([{text:"Edit",icon:"edit",handler:f},{text:"Delete",icon:"delete",handler(){t.onTodoDelete(e.id)}}]);return i.append(m,v,y.button,y.menu),i.addEventListener("click",(e=>{e.target.closest("button")||y.menu.contains(e.target)||f()})),i}const k=(e,t,o=null)=>{const n=document.createElement("button"),d=p(),r=e=>{d.textContent=e?"check_box":"check_box_outline_blank"};return r(e),n.replaceChildren(d),n.addEventListener("click",(()=>{o(t,r)})),n},T=e=>{const t=+e;if(!t)return"";const o=document.createElement("span");o.classList.add("priority",`priority-${e}`);const n=p("flag"),d=document.createElement("span");return d.classList.add("text"),d.textContent=C(t),o.append(n,d),o},C=e=>{switch(e){case 1:return"Low";case 2:return"Normal";case 3:return"High";default:return""}},S=e=>{if(!e)return"";const t=document.createElement("p");return t.classList.add("description"),t.textContent=e,t},w=(e,t=!1)=>{if(!e)return"";const{daysDiff:o,relativeDateDescription:n}=D(e,{showOverdue:t});if(o>-1&&t)return"";const d=document.createElement("div");d.classList.add("date"),d.classList.toggle("due",o<1),d.classList.toggle("overdue",t);const r=p("hourglass_"+(o<0?"bottom":"top")),i=document.createElement("span");return i.classList.add("text"),i.textContent=n,d.append(r,i),d};let x=null;function q(e=null,t=null){x?.classList.remove("hidden"),l.todo.reset(),e?(x=e,e.classList.add("hidden"),e.insertAdjacentElement("afterend",l.todo)):u.todoList.append(l.todo),l.todo.hidden=!1,e!==u.addTodoButton&&function(e){const t={title:l.todo.querySelector("#todo-title"),description:l.todo.querySelector("#todo-description"),dueDate:l.todo.querySelector("#todo-due-date"),priority:l.todo.querySelector("#todo-priority")};for(const o in t)void 0!==e[o]&&null!==e[o]&&""!==e[o]&&(t[o].value=e[o])}(t),l.todo.querySelector("input").focus(),l.todo.addEventListener("keydown",O),u.addTodoButton.disabled=x===u.addTodoButton}function I(){l.todo.removeEventListener("keydown",O),l.todo.hidden=!0,x?.classList.remove("hidden"),u.addTodoButton.disabled=!1,x=null}const P={addTodo:null,editTodo:null};function B(e,t){P[e]=e=>{e.preventDefault();const o=new FormData(e.target),n=Object.fromEntries(o),d=(r=x)&&r!==r.addTodoButton?r.dataset.id:null;var r;t(n,d,N),I()}}function O(e){"Escape"===e.key&&I()}l.todo.querySelector(".cancel-btn").addEventListener("click",(()=>{I()})),u.addTodoButton.addEventListener("click",(()=>{q(u.addTodoButton),l.todo.removeEventListener("submit",P.editTodo),l.todo.addEventListener("submit",P.addTodo)}));const _=m(u.todoList,b);let M=null,N=null;function R(e,t,o){M=e,N=()=>{_(M(),t,o)},N()}function A(e){const t=u.todoList?.querySelector(`[data-id="${e}"]`);t&&u.todoList.removeChild(t)}const $=(e,t=null,o="tag")=>{const n=p(o);if(!t)return void u.projectHeading.replaceChildren(n,e);const d=document.createElement("input");u.projectHeading.replaceChildren(n,d),d.value=e,d.addEventListener("blur",t),d.addEventListener("keydown",(e=>{"Enter"!==e.key&&"Escape"!==e.key||d.blur()}))},{confirmDialog:F}=u,H=F.querySelector(".dialog-text"),Y=F.querySelector("#confirm-btn");F.querySelector("#cancel-btn").addEventListener("click",(()=>{F.close()}));const{completedContainer:K,completedList:X}=u,G=K.querySelector(".fold-btn");function J(e,t){const o=document.createElement("li");o.classList.add("completed-item"),o.dataset.id=e.id;const n=k(e.isComplete,e.id,t);n.classList.add("completed-btn");const{relativeDateDescription:d}=D(e.completedDate,{onlyDate:!0}),r=document.createElement("span");r.classList.add("completed-date"),r.textContent=d;const i=document.createElement("p");return i.classList.add("title"),i.textContent=e.title,o.append(n,r,i),o}function z(){K.classList.toggle("hidden",0===X.children.length)}G.addEventListener("click",(()=>{X.classList.toggle("hidden"),G.querySelector("span.icon").textContent=X.classList.contains("hidden")?"unfold_more":"unfold_less"}));const Q=u.themeSelector.querySelector(".icon"),U=window.matchMedia("(prefers-color-scheme: dark)"),V=()=>{const e=document.documentElement.dataset.theme;return e?"dark"===e:U.matches},W=e=>{document.documentElement.dataset.theme=e,Q.textContent="dark"===e?"dark_mode":"light_mode"},Z=e=>{W(e.matches?"dark":"light"),oe()},ee=()=>{W(U.matches?"dark":"light"),oe()};let te=null;const oe=(e=te)=>{if(!e)return;const t=e.querySelector(".icon"),o=e.querySelector(".text"),n=V();t.textContent=n?"light_mode":"dark_mode",o.textContent=n?"Light Mode":"Dark Mode"};window.addEventListener("load",(()=>{(()=>{const e=localStorage.getItem("color-theme");e?W(e):(ee(),U.addEventListener("change",Z))})(),(()=>{const e=h([{text:V()?"Light Mode":"Dark Mode",icon:V()?"light_mode":"dark_mode",handler(){W(V()?"light":"dark"),oe(),localStorage.setItem("color-theme",V()?"dark":"light"),U.removeEventListener("change",Z)}},{text:"System Theme",icon:"desktop_windows",handler(){localStorage.removeItem("color-theme"),ee(),U.addEventListener("change",Z)}}],u.themeSelector);te=e.menu.firstElementChild,u.themeSelector.insertAdjacentElement("afterend",e.menu)})()}));const ne=navigator.userAgent,de=/iPad|iPhone|iPod/.test(ne)||ne.includes("Macintosh");document.addEventListener("keydown",(e=>{(e.ctrlKey&&"k"===e.key&&!de||de&&e.metaKey&&"k"===e.key)&&(e.preventDefault(),u.addTodoButton.click())})),u.addTodoButton.querySelector("code").textContent=de?"⌘ K":"Ctrl + K";const re={name:"Inbox",id:null};let ie=re;u.inboxItem.dataset.id=re.id;const ce={onTodoComplete:le(),onTodoDelete:ue},se={onClick:ae,onDelete:function(e,t={confirm:"Yes",message:"Confirm?"}){return H.textContent=t.message,Y.textContent=t.confirm,t=>{const o=()=>{e(t),F.close()};F.showModal(),Y.addEventListener("click",o,{once:!0}),F.addEventListener("close",(()=>{Y.removeEventListener("click",o)}))}}((function(e){a.removeProject(e),function(e){const t=u.projectList.querySelector(`[data-id="${e}"]`);t?.remove()}(e),e===ie.id&&ae()}),{message:"Are you sure you want to proceed?",confirm:"Delete"})};function ae(e){ie!==e&&(ie=e||re,$(ie.name,ie.id&&me,ie.id?"tag":"inbox"),R((()=>s.getIncompleteTodosForProject(ie.id)),ce),((e,t)=>{if(0===e.length)return X.replaceChildren(),void K.classList.add("hidden");K.classList.remove("hidden"),m(X,J)(e,t)})(s.getCompletedTodosForProject(ie.id),pe),f(ie.id),I(),u.addTodoButton.classList.remove("hidden"))}function le(e=!0){return t=>{const o=s.getTodoByID(t);o.markComplete(),A(t),e&&function(e,t){const o=J(e,t);X.prepend(o),z()}(o,pe)}}function ue(e){s.removeTodo(e),A(e)}function me(e){const t=e.target.value;var o,n;ie.name=t,o=ie.id,n=ie.name,u.projectList.querySelector(`.nav-item[data-id="${o}"]`).querySelector(".project-btn span.text").textContent=n}function pe(e){s.getTodoByID(e).markIncomplete(),function(e){const t=X.querySelector(`.completed-item[data-id="${e}"]`);t?.remove(),z()}(e),R((()=>s.getIncompleteTodosForProject(ie.id)),ce)}function he(e,t,o){ie={id:t.id},$(t.name,null,t.icon),R(e,{onTodoComplete:le(!1),onTodoDelete:ue},o),f(ie.id),I(),u.addTodoButton.classList.add("hidden"),u.completedContainer.classList.add("hidden"),u.addTodoButton.disabled=!0}l.project.addEventListener("submit",(function(e){e.preventDefault();const t=new FormData(e.target).get("name"),o=new a(t);e.target.reset(),e.target.querySelector("input").blur(),o&&(v(a.projects,se),ae(o))})),B("addTodo",(function(e){!function(e,t){const o=b(e,t);u.todoList.append(o)}(new s(e,ie),ce)})),B("editTodo",(function(e,t,o){const n=s.getTodoByID(t);for(const t in e)n.updateProperty(t,e[t]);o()})),u.inboxButton.addEventListener("click",(()=>{ae()})),u.todayNavButton.addEventListener("click",(()=>{he((()=>s.incompleteTodosToday.concat(s.overdueTodos)),{name:"Today",id:"today",icon:"today"},{showProject:!0,showOverdue:!0})})),u.priorityNavButton.addEventListener("click",(()=>{he((()=>s.incompleteHighPriorityTodos),{name:"High Priority",id:"priority",icon:"flag"},{showProject:!0,showPriority:!1})})),window.addEventListener("beforeunload",(()=>{localStorage.setItem("todos",(()=>{const e=s.todos.map((e=>({...e,id:e.id,priority:e.priority,dueDate:e.dueDate,project:{id:e.project.id}}))),t=a.projects.map((e=>({name:e.name,id:e.id})));return JSON.stringify({todos:e,projects:t})})()),localStorage.setItem("session",ie.id)})),window.addEventListener("load",(()=>{const e=localStorage.getItem("todos");e&&(e=>{const{todos:t,projects:o}=JSON.parse(e);if(o)for(const e of o)new a(e.name,e.id);if(t)for(const e of t){const{project:t,...o}=e,n=a.getProjectByID(t.id)??null;new s(o,n)}})(e),v(a.projects,se);const t=localStorage.getItem("session");u.sidebar.querySelector(`.nav-item[data-id="${t}"] .project-btn`).click()}))}},o={};function n(e){var d=o[e];if(void 0!==d)return d.exports;var r=o[e]={exports:{}};return t[e](r,r.exports,n),r.exports}n.m=t,e=[],n.O=(t,o,d,r)=>{if(!o){var i=1/0;for(l=0;l<e.length;l++){for(var[o,d,r]=e[l],c=!0,s=0;s<o.length;s++)(!1&r||i>=r)&&Object.keys(n.O).every((e=>n.O[e](o[s])))?o.splice(s--,1):(c=!1,r<i&&(i=r));if(c){e.splice(l--,1);var a=d();void 0!==a&&(t=a)}}return t}r=r||0;for(var l=e.length;l>0&&e[l-1][2]>r;l--)e[l]=e[l-1];e[l]=[o,d,r]},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={792:0};n.O.j=t=>0===e[t];var t=(t,o)=>{var d,r,[i,c,s]=o,a=0;if(i.some((t=>0!==e[t]))){for(d in c)n.o(c,d)&&(n.m[d]=c[d]);if(s)var l=s(n)}for(t&&t(o);a<i.length;a++)r=i[a],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(l)},o=self.webpackChunktodo_list=self.webpackChunktodo_list||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var d=n.O(void 0,[447],(()=>n(377)));d=n.O(d)})();
//# sourceMappingURL=main.d5f11337bf5637672730.js.map